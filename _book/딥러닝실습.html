<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>KAIST MFE, 2024 Fall - 2&nbsp; 딥러닝 Ch1 실습</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./시뮬레이션1.html" rel="next">
<link href="./딥러닝2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./딥러닝1.html">딥러닝(’24 가을)</a></li><li class="breadcrumb-item"><a href="./딥러닝실습.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">딥러닝 Ch1 실습</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">KAIST MFE, 2024 Fall</a> 
        <div class="sidebar-tools-main">
    <a href="./KAIST-MFE,-2024-Fall.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">머신러닝(’24 가을)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./머신러닝1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">머신러닝 Ch1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./머신러닝실습.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">머신러닝 실습</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">딥러닝(’24 가을)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./딥러닝1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">딥러닝 Ch1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./딥러닝2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">딥러닝 Ch2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./딥러닝실습.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">딥러닝 Ch1 실습</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">시뮬레이션 방법론(’24 가을)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./시뮬레이션1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">시뮬레이션방법론 Ch1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./시뮬레이션실습.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">시뮬레이션방법론 실습</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./시뮬레이션hw1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">시뮬레이션 방법론 과제1 (베리어옵션)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">이자율파생상품(’24 가을)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./이자율1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">이자율파생상품 1주차</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">수치해석학(’24 가을)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./수치해석1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">수치해석학 Ch1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./수치해석2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">수치해석학 Ch2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./수치해석실습.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">수치해석기법 실습</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">금융시장 리스크관리(’24 가을)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./리스크관리1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">금융시장 리스크관리 1~2주차</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./리스크관리hw1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">금융시장 리스크관리 과제1</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">미시경제학(’24 가을)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./미시1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">미시경제학 Ch1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./미시hw1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Microanalysis of financial economics Assignment1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./미시hw2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Microanalysis of financial economics Assignment2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./미시hw3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Microanalysis of financial economics Assignment3</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">글로벌 지속가능회계(’24 가을)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./글로벌회계1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">글로벌 지속가능회계 1주차</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#텐서-데이터-만들기" id="toc-텐서-데이터-만들기" class="nav-link active" data-scroll-target="#텐서-데이터-만들기"><span class="header-section-number">2.1</span> 1. 텐서 데이터 만들기</a></li>
  <li><a href="#텐서-데이터-타입-크기" id="toc-텐서-데이터-타입-크기" class="nav-link" data-scroll-target="#텐서-데이터-타입-크기"><span class="header-section-number">2.2</span> 2. 텐서 데이터 타입, 크기</a></li>
  <li><a href="#수학-연산의-적용" id="toc-수학-연산의-적용" class="nav-link" data-scroll-target="#수학-연산의-적용"><span class="header-section-number">2.3</span> 3. 수학 연산의 적용</a></li>
  <li><a href="#텐서-데이터의-분할-및-통합" id="toc-텐서-데이터의-분할-및-통합" class="nav-link" data-scroll-target="#텐서-데이터의-분할-및-통합"><span class="header-section-number">2.4</span> 4. 텐서 데이터의 분할 및 통합</a></li>
  <li><a href="#tf.data를-활용한-데이터-전처리" id="toc-tf.data를-활용한-데이터-전처리" class="nav-link" data-scroll-target="#tf.data를-활용한-데이터-전처리"><span class="header-section-number">2.5</span> 5. tf.data를 활용한 데이터 전처리</a></li>
  <li><a href="#선형회귀분석-low-lever-ver." id="toc-선형회귀분석-low-lever-ver." class="nav-link" data-scroll-target="#선형회귀분석-low-lever-ver."><span class="header-section-number">2.6</span> 6. 선형회귀분석 (low-lever ver.)</a></li>
  <li><a href="#선형회귀분석-tf.keras-ver." id="toc-선형회귀분석-tf.keras-ver." class="nav-link" data-scroll-target="#선형회귀분석-tf.keras-ver."><span class="header-section-number">2.7</span> 7. 선형회귀분석 (tf.keras ver.)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./딥러닝1.html">딥러닝(’24 가을)</a></li><li class="breadcrumb-item"><a href="./딥러닝실습.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">딥러닝 Ch1 실습</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">딥러닝 Ch1 실습</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="텐서-데이터-만들기" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="텐서-데이터-만들기"><span class="header-section-number">2.1</span> 1. 텐서 데이터 만들기</h2>
<div id="cell-2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-3" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> tf.constant( <span class="dv">123</span> ) <span class="co"># 텐서 상수. numpy array 같은 데이터타입임.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>&lt;tf.Tensor: shape=(), dtype=int32, numpy=123&gt;</code></pre>
</div>
</div>
<div id="cell-4" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(123, shape=(), dtype=int32)</code></pre>
</div>
</div>
<div id="cell-5" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>test.numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>123</code></pre>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tf.constant([<span class="fl">1.2</span>, <span class="dv">5</span>, np.pi], dtype <span class="op">=</span> tf.float32)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>&lt;tf.Tensor: shape=(3,), dtype=float32, numpy=array([1.2      , 5.       , 3.1415927], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>ndarr <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>], [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ndarr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>array([[1, 2, 3],
       [4, 5, 6]])</code></pre>
</div>
</div>
<div id="cell-8" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tsarr <span class="op">=</span> tf.convert_to_tensor( ndarr )</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>tsarr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>&lt;tf.Tensor: shape=(2, 3), dtype=int64, numpy=
array([[1, 2, 3],
       [4, 5, 6]])&gt;</code></pre>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tsones <span class="op">=</span> tf.ones((<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>tsones</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>&lt;tf.Tensor: shape=(2, 3), dtype=float32, numpy=
array([[1., 1., 1.],
       [1., 1., 1.]], dtype=float32)&gt;</code></pre>
</div>
</div>
</section>
<section id="텐서-데이터-타입-크기" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="텐서-데이터-타입-크기"><span class="header-section-number">2.2</span> 2. 텐서 데이터 타입, 크기</h2>
<div id="cell-11" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tsarr.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>TensorShape([2, 3])</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tsarr.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>2</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>tsarr.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>tf.int64</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tf.cast( tsarr, dtype<span class="op">=</span>tf.float64 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>&lt;tf.Tensor: shape=(2, 3), dtype=float64, numpy=
array([[1., 2., 3.],
       [4., 5., 6.]])&gt;</code></pre>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tsarr[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>&lt;tf.Tensor: shape=(3,), dtype=int64, numpy=array([1, 2, 3])&gt;</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tsarr[:<span class="dv">1</span>,:<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>&lt;tf.Tensor: shape=(1, 1), dtype=int64, numpy=array([[1]])&gt;</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>tsarr[<span class="dv">0</span>,<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>&lt;tf.Tensor: shape=(), dtype=int64, numpy=1&gt;</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> tf.random.uniform(shape<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">4</span>)) <span class="co"># shape 생략 가능</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>&lt;tf.Tensor: shape=(3, 4), dtype=float32, numpy=
array([[0.36321807, 0.29708588, 0.04835212, 0.6580317 ],
       [0.52478623, 0.81622696, 0.68001425, 0.35392594],
       [0.60432065, 0.5515584 , 0.92308843, 0.2798295 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>t.numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array([[0.36321807, 0.29708588, 0.04835212, 0.6580317 ],
       [0.52478623, 0.81622696, 0.68001425, 0.35392594],
       [0.60432065, 0.5515584 , 0.92308843, 0.2798295 ]], dtype=float32)</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tnormal <span class="op">=</span> tf.random.normal((<span class="dv">3</span>,<span class="dv">4</span>), mean <span class="op">=</span> <span class="dv">0</span>, stddev <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>tnormal</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>&lt;tf.Tensor: shape=(3, 4), dtype=float32, numpy=
array([[ 1.2684143 ,  0.5634787 , -0.8527982 ,  0.15773794],
       [ 0.9406849 ,  0.30044   ,  0.81672424,  1.6540827 ],
       [-0.04494214, -1.9484011 , -0.03741917, -0.0658213 ]],
      dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>t_tr <span class="op">=</span> tf.transpose( t )</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>t_tr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>&lt;tf.Tensor: shape=(4, 3), dtype=float32, numpy=
array([[0.36321807, 0.52478623, 0.60432065],
       [0.29708588, 0.81622696, 0.5515584 ],
       [0.04835212, 0.68001425, 0.92308843],
       [0.6580317 , 0.35392594, 0.2798295 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>t_sh <span class="op">=</span> tf.reshape( t, shape <span class="op">=</span> (<span class="dv">6</span>,<span class="dv">2</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>t_sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>&lt;tf.Tensor: shape=(6, 2), dtype=float32, numpy=
array([[0.36321807, 0.29708588],
       [0.04835212, 0.6580317 ],
       [0.52478623, 0.81622696],
       [0.68001425, 0.35392594],
       [0.60432065, 0.5515584 ],
       [0.92308843, 0.2798295 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
</section>
<section id="수학-연산의-적용" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="수학-연산의-적용"><span class="header-section-number">2.3</span> 3. 수학 연산의 적용</h2>
<div id="cell-24" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> tf.constant(<span class="dv">10</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> tf.constant(<span class="dv">20</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> tf.constant(<span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-25" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ad <span class="op">=</span> tf.add(a,b) <span class="co"># substract, multiply, divide 가능</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ad.numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>30</code></pre>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>tf.reduce_mean( [a,b,c] ).numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>20</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>tf.reduce_sum( [a,b,c] ).numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>60</code></pre>
</div>
</div>
<div id="cell-28" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="op">=</span> tf.random.uniform( shape<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">2</span>), minval<span class="op">=-</span><span class="fl">1.0</span>, maxval<span class="op">=</span><span class="fl">1.0</span> )</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>M1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>&lt;tf.Tensor: shape=(5, 2), dtype=float32, numpy=
array([[ 0.9962559 ,  0.7100415 ],
       [ 0.06644487, -0.17041707],
       [ 0.7292304 , -0.49121428],
       [-0.9295962 , -0.6074953 ],
       [ 0.43700218, -0.5817137 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>M2 <span class="op">=</span> tf.random.normal( shape<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">2</span>), mean<span class="op">=</span><span class="dv">0</span>, stddev<span class="op">=</span><span class="dv">1</span> )</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>M2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>&lt;tf.Tensor: shape=(5, 2), dtype=float32, numpy=
array([[ 0.3262252 , -1.6307284 ],
       [ 1.0629762 , -0.9531726 ],
       [ 1.3960881 , -0.96611947],
       [ 0.5364423 ,  0.5114645 ],
       [ 0.0176798 , -1.0373931 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-30" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>tf.reduce_mean( M1, axis<span class="op">=</span><span class="dv">0</span> ).numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>array([ 0.25986743, -0.22815976], dtype=float32)</code></pre>
</div>
</div>
<div id="cell-31" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>tf.reduce_mean( M1, axis<span class="op">=</span><span class="dv">1</span> ).numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>array([ 0.8531487 , -0.0519861 ,  0.11900806, -0.76854575, -0.07235575],
      dtype=float32)</code></pre>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>tf.multiply( M1, M2 ).numpy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>&lt;bound method _EagerTensorBase.numpy of &lt;tf.Tensor: shape=(5, 2), dtype=float32, numpy=
array([[ 0.32500377, -1.1578848 ],
       [ 0.07062932,  0.16243689],
       [ 1.0180699 ,  0.47457168],
       [-0.4986747 , -0.31071228],
       [ 0.00772611,  0.60346574]], dtype=float32)&gt;&gt;</code></pre>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>tf.matmul( M1, tf.transpose(M2) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>&lt;tf.Tensor: shape=(5, 5), dtype=float32, numpy=
array([[-0.8328811 ,  0.38220417,  0.7048761 ,  0.8975948 , -0.7189786 ],
       [ 0.29957995,  0.2330662 ,  0.25740615, -0.05151844,  0.17796423],
       [ 1.0389304 ,  1.2433666 ,  1.4926416 ,  0.13995136,  0.52247494],
       [ 0.6874021 , -0.4090908 , -0.7108851 , -0.80938697,  0.6137764 ],
       [ 1.091178  ,  1.0189965 ,  1.1720984 , -0.06309943,  0.61119187]],
      dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>tf.matmul( tf.transpose(M1), M2 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>&lt;tf.Tensor: shape=(2, 2), dtype=float32, numpy=
array([[ 0.9227544 , -3.3212786 ],
       [-0.97146505, -0.22812282]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-35" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>tf.transpose(M1) <span class="op">@</span> M2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>&lt;tf.Tensor: shape=(2, 2), dtype=float32, numpy=
array([[ 0.9227544 , -3.3212786 ],
       [-0.97146505, -0.22812282]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>np.linalg.det( M1 <span class="op">@</span> tf.transpose(M2) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>-1.7482287e-23</code></pre>
</div>
</div>
<div id="cell-37" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>np.linalg.det( tf.transpose(M1) <span class="op">@</span> M2 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>-3.4370074</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>np.linalg.inv( tf.transpose(M1) <span class="op">@</span> M2 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([[ 0.06637251, -0.9663286 ],
       [-0.28264853, -0.26847613]], dtype=float32)</code></pre>
</div>
</div>
<div id="cell-39" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>np.linalg.eig(tf.transpose(M1) <span class="op">@</span> M2 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>EigResult(eigenvalues=array([ 2.2334855, -1.5388538], dtype=float32), eigenvectors=array([[ 0.93018395,  0.803395  ],
       [-0.36709383,  0.59544647]], dtype=float32))</code></pre>
</div>
</div>
<div id="cell-40" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>tf.norm( M1, <span class="bu">ord</span><span class="op">=</span><span class="dv">2</span>, axis<span class="op">=</span><span class="dv">1</span> ).numpy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>&lt;bound method _EagerTensorBase.numpy of &lt;tf.Tensor: shape=(5,), dtype=float32, numpy=
array([1.2233907 , 0.18291228, 0.8792431 , 1.1104952 , 0.7275725 ],
      dtype=float32)&gt;&gt;</code></pre>
</div>
</div>
</section>
<section id="텐서-데이터의-분할-및-통합" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="텐서-데이터의-분할-및-통합"><span class="header-section-number">2.4</span> 4. 텐서 데이터의 분할 및 통합</h2>
<div id="cell-42" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> tf.random.uniform((<span class="dv">6</span>,))</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>t.numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>array([0.02300322, 0.7006937 , 0.41715956, 0.25560915, 0.6631763 ,
       0.41954446], dtype=float32)</code></pre>
</div>
</div>
<div id="cell-43" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>t_spl <span class="op">=</span> tf.split( t, num_or_size_splits<span class="op">=</span><span class="dv">3</span> )</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>[ item.numpy() <span class="cf">for</span> item <span class="kw">in</span> t_spl ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>[array([0.02300322, 0.7006937 ], dtype=float32),
 array([0.41715956, 0.25560915], dtype=float32),
 array([0.6631763 , 0.41954446], dtype=float32)]</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>t_spl2 <span class="op">=</span> tf.split( t, num_or_size_splits<span class="op">=</span>[<span class="dv">4</span>,<span class="dv">2</span>])</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>[ item.numpy() <span class="cf">for</span> item <span class="kw">in</span> t_spl2 ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>[array([0.02300322, 0.7006937 , 0.41715956, 0.25560915], dtype=float32),
 array([0.6631763 , 0.41954446], dtype=float32)]</code></pre>
</div>
</div>
<div id="cell-45" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> tf.random.uniform((<span class="dv">6</span>,<span class="dv">3</span>))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>t2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>&lt;tf.Tensor: shape=(6, 3), dtype=float32, numpy=
array([[0.20208406, 0.14229345, 0.24287081],
       [0.28123713, 0.9822639 , 0.5934299 ],
       [0.06746602, 0.44820297, 0.55084395],
       [0.12668848, 0.9349866 , 0.27638876],
       [0.7941842 , 0.49613452, 0.26152658],
       [0.11516786, 0.5283252 , 0.17477489]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-46" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>t_spl3 <span class="op">=</span> tf.split( t2, num_or_size_splits<span class="op">=</span>[<span class="dv">4</span>,<span class="dv">2</span>], axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>[ item.numpy() <span class="cf">for</span> item <span class="kw">in</span> t_spl3 ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>[array([[0.20208406, 0.14229345, 0.24287081],
        [0.28123713, 0.9822639 , 0.5934299 ],
        [0.06746602, 0.44820297, 0.55084395],
        [0.12668848, 0.9349866 , 0.27638876]], dtype=float32),
 array([[0.7941842 , 0.49613452, 0.26152658],
        [0.11516786, 0.5283252 , 0.17477489]], dtype=float32)]</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>t_conc <span class="op">=</span> tf.concat([t2, tf.reshape(t, (<span class="dv">6</span>,<span class="dv">1</span>))], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>t_conc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>&lt;tf.Tensor: shape=(6, 4), dtype=float32, numpy=
array([[0.20208406, 0.14229345, 0.24287081, 0.02300322],
       [0.28123713, 0.9822639 , 0.5934299 , 0.7006937 ],
       [0.06746602, 0.44820297, 0.55084395, 0.41715956],
       [0.12668848, 0.9349866 , 0.27638876, 0.25560915],
       [0.7941842 , 0.49613452, 0.26152658, 0.6631763 ],
       [0.11516786, 0.5283252 , 0.17477489, 0.41954446]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div id="cell-48" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>tf.concat([t_conc, tf.random.uniform((<span class="dv">1</span>,<span class="dv">4</span>))], axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>&lt;tf.Tensor: shape=(7, 4), dtype=float32, numpy=
array([[0.20208406, 0.14229345, 0.24287081, 0.02300322],
       [0.28123713, 0.9822639 , 0.5934299 , 0.7006937 ],
       [0.06746602, 0.44820297, 0.55084395, 0.41715956],
       [0.12668848, 0.9349866 , 0.27638876, 0.25560915],
       [0.7941842 , 0.49613452, 0.26152658, 0.6631763 ],
       [0.11516786, 0.5283252 , 0.17477489, 0.41954446],
       [0.3500303 , 0.06093681, 0.0672853 , 0.09213388]], dtype=float32)&gt;</code></pre>
</div>
</div>
</section>
<section id="tf.data를-활용한-데이터-전처리" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="tf.data를-활용한-데이터-전처리"><span class="header-section-number">2.5</span> 5. tf.data를 활용한 데이터 전처리</h2>
<div id="cell-50" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> [ <span class="fl">1.1</span>, <span class="fl">2.2</span>, <span class="fl">3.3</span>, <span class="fl">4.4</span>, <span class="fl">5.5</span>, <span class="fl">6.6</span>, <span class="fl">7.7</span> ]</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>arr1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>[1.1, 2.2, 3.3, 4.4, 5.5, 6.6, 7.7]</code></pre>
</div>
</div>
<div id="cell-51" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>ds1 <span class="op">=</span> tf.data.Dataset.from_tensor_slices( arr1 )</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( ds1 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.float32, name=None)&gt;</code></pre>
</div>
</div>
<div id="cell-52" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds1:</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(item)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(1.1, shape=(), dtype=float32)
tf.Tensor(2.2, shape=(), dtype=float32)
tf.Tensor(3.3, shape=(), dtype=float32)
tf.Tensor(4.4, shape=(), dtype=float32)
tf.Tensor(5.5, shape=(), dtype=float32)
tf.Tensor(6.6, shape=(), dtype=float32)
tf.Tensor(7.7, shape=(), dtype=float32)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:19.694220: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>ds1_batch <span class="op">=</span> ds1.batch(<span class="dv">3</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds1_batch: <span class="bu">print</span>( item )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor([1.1 2.2 3.3], shape=(3,), dtype=float32)
tf.Tensor([4.4 5.5 6.6], shape=(3,), dtype=float32)
tf.Tensor([7.7], shape=(1,), dtype=float32)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:19.707469: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">1</span>)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> tf.random.uniform( shape <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">3</span>), dtype <span class="op">=</span> tf.float32 )</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> tf.<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-55" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>X.numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>array([[0.16513085, 0.9014813 , 0.6309742 ],
       [0.4345461 , 0.29193902, 0.64250207],
       [0.9757855 , 0.43509948, 0.6601019 ],
       [0.60489583, 0.6366315 , 0.6144488 ],
       [0.8893349 , 0.6277617 , 0.53197503],
       [0.02597821, 0.44087505, 0.25267076],
       [0.8862232 , 0.88729346, 0.78728163],
       [0.05955195, 0.0710938 , 0.3084147 ],
       [0.25118268, 0.9084705 , 0.47147965],
       [0.24238515, 0.63300395, 0.5860311 ]], dtype=float32)</code></pre>
</div>
</div>
<div id="cell-56" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>Y.numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10], dtype=int32)</code></pre>
</div>
</div>
<div id="cell-57" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>ds_X <span class="op">=</span> tf.data.Dataset.from_tensor_slices( X )</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>ds_Y <span class="op">=</span> tf.data.Dataset.from_tensor_slices( Y )</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>ds_joint <span class="op">=</span> tf.data.Dataset.<span class="bu">zip</span>((ds_X, ds_Y))</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>ds_joint2 <span class="op">=</span> tf.data.Dataset.from_tensor_slices((X, Y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-58" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_X: <span class="bu">print</span>(ds_X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(3,), dtype=tf.float32, name=None)&gt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:19.907884: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_Y: <span class="bu">print</span>(ds_Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;
&lt;_TensorSliceDataset element_spec=TensorSpec(shape=(), dtype=tf.int32, name=None)&gt;</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:19.923096: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-60" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_joint:</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>( item[<span class="dv">0</span>].numpy(),<span class="st">':'</span>,item[<span class="dv">1</span>].numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.16513085 0.9014813  0.6309742 ] : 1
[0.4345461  0.29193902 0.64250207] : 2
[0.9757855  0.43509948 0.6601019 ] : 3
[0.60489583 0.6366315  0.6144488 ] : 4
[0.8893349  0.6277617  0.53197503] : 5
[0.02597821 0.44087505 0.25267076] : 6
[0.8862232  0.88729346 0.78728163] : 7
[0.05955195 0.0710938  0.3084147 ] : 8
[0.25118268 0.9084705  0.47147965] : 9
[0.24238515 0.63300395 0.5860311 ] : 10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:19.939704: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-61" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 똑같음</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_joint2:</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>( item[<span class="dv">0</span>].numpy(),<span class="st">':'</span>,item[<span class="dv">1</span>].numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.16513085 0.9014813  0.6309742 ] : 1
[0.4345461  0.29193902 0.64250207] : 2
[0.9757855  0.43509948 0.6601019 ] : 3
[0.60489583 0.6366315  0.6144488 ] : 4
[0.8893349  0.6277617  0.53197503] : 5
[0.02597821 0.44087505 0.25267076] : 6
[0.8862232  0.88729346 0.78728163] : 7
[0.05955195 0.0710938  0.3084147 ] : 8
[0.25118268 0.9084705  0.47147965] : 9
[0.24238515 0.63300395 0.5860311 ] : 10</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:19.952051: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-62" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>ds_trans <span class="op">=</span> ds_joint.<span class="bu">map</span>( <span class="kw">lambda</span> x, y: (x<span class="op">*</span><span class="dv">2</span><span class="op">-</span><span class="dv">1</span>, y<span class="op">/</span><span class="dv">10</span>))</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_trans:</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>( item[<span class="dv">0</span>].numpy(),<span class="st">':'</span>,item[<span class="dv">1</span>].numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[-0.6697383   0.80296254  0.26194835] : 0.1
[-0.13090777 -0.41612196  0.28500414] : 0.2
[ 0.951571   -0.12980103  0.32020378] : 0.3
[0.20979166 0.27326298 0.22889757] : 0.4
[0.77866983 0.25552344 0.06395006] : 0.5
[-0.9480436  -0.11824989 -0.49465847] : 0.6
[0.7724464  0.7745869  0.57456326] : 0.7
[-0.8808961 -0.8578124 -0.3831706] : 0.8
[-0.49763465  0.816941   -0.05704069] : 0.9
[-0.5152297   0.2660079   0.17206216] : 1.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:47.889358: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-63" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>ds_trans2 <span class="op">=</span> ds_joint.<span class="bu">map</span>( <span class="kw">lambda</span> x, y: ([x[<span class="dv">0</span>]<span class="op">+</span><span class="dv">1</span>,x[<span class="dv">1</span>]<span class="op">+</span><span class="dv">2</span>,x[<span class="dv">2</span>]<span class="op">+</span><span class="dv">3</span>], y<span class="op">/</span><span class="dv">10</span>))</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_trans2:</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>( item[<span class="dv">0</span>].numpy(),<span class="st">':'</span>,item[<span class="dv">1</span>].numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1.1651309 2.9014812 3.6309743] : 0.1
[1.4345461 2.291939  3.642502 ] : 0.2
[1.9757855 2.4350996 3.660102 ] : 0.3
[1.6048958 2.6366315 3.6144488] : 0.4
[1.8893349 2.6277618 3.531975 ] : 0.5
[1.0259782 2.440875  3.2526708] : 0.6
[1.8862232 2.8872933 3.7872815] : 0.7
[1.059552  2.0710938 3.3084147] : 0.8
[1.2511827 2.9084706 3.4714797] : 0.9
[1.2423851 2.633004  3.586031 ] : 1.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:50.254590: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-64" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>ds_shfl <span class="op">=</span> ds_joint.shuffle( buffer_size <span class="op">=</span> <span class="bu">len</span>( X ) )</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_shfl:</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>( item[<span class="dv">0</span>].numpy(),<span class="st">':'</span>, item[<span class="dv">1</span>].numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.60489583 0.6366315  0.6144488 ] : 4
[0.25118268 0.9084705  0.47147965] : 9
[0.16513085 0.9014813  0.6309742 ] : 1
[0.24238515 0.63300395 0.5860311 ] : 10
[0.4345461  0.29193902 0.64250207] : 2
[0.8862232  0.88729346 0.78728163] : 7
[0.05955195 0.0710938  0.3084147 ] : 8
[0.02597821 0.44087505 0.25267076] : 6
[0.9757855  0.43509948 0.6601019 ] : 3
[0.8893349  0.6277617  0.53197503] : 5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:50.712884: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-65" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>ds_batch <span class="op">=</span> ds_joint.batch(<span class="dv">3</span>, drop_remainder <span class="op">=</span> <span class="va">True</span> )</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_batch :</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>( item[<span class="dv">0</span>].numpy(),<span class="st">':'</span>, item[<span class="dv">1</span>].numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.16513085 0.9014813  0.6309742 ]
 [0.4345461  0.29193902 0.64250207]
 [0.9757855  0.43509948 0.6601019 ]] : [1 2 3]
[[0.60489583 0.6366315  0.6144488 ]
 [0.8893349  0.6277617  0.53197503]
 [0.02597821 0.44087505 0.25267076]] : [4 5 6]
[[0.8862232  0.88729346 0.78728163]
 [0.05955195 0.0710938  0.3084147 ]
 [0.25118268 0.9084705  0.47147965]] : [7 8 9]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:51.035230: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-66" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>ds_rpt <span class="op">=</span> ds_joint.batch(<span class="dv">3</span>, drop_remainder <span class="op">=</span> <span class="va">True</span> ).repeat( count <span class="op">=</span> <span class="dv">2</span> )</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_rpt :</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>( item[<span class="dv">0</span>].numpy(),<span class="st">':'</span>, item[<span class="dv">1</span>].numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.16513085 0.9014813  0.6309742 ]
 [0.4345461  0.29193902 0.64250207]
 [0.9757855  0.43509948 0.6601019 ]] : [1 2 3]
[[0.60489583 0.6366315  0.6144488 ]
 [0.8893349  0.6277617  0.53197503]
 [0.02597821 0.44087505 0.25267076]] : [4 5 6]
[[0.8862232  0.88729346 0.78728163]
 [0.05955195 0.0710938  0.3084147 ]
 [0.25118268 0.9084705  0.47147965]] : [7 8 9]
[[0.16513085 0.9014813  0.6309742 ]
 [0.4345461  0.29193902 0.64250207]
 [0.9757855  0.43509948 0.6601019 ]] : [1 2 3]
[[0.60489583 0.6366315  0.6144488 ]
 [0.8893349  0.6277617  0.53197503]
 [0.02597821 0.44087505 0.25267076]] : [4 5 6]
[[0.8862232  0.88729346 0.78728163]
 [0.05955195 0.0710938  0.3084147 ]
 [0.25118268 0.9084705  0.47147965]] : [7 8 9]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:51.341547: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-67" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>ds_rpt2 <span class="op">=</span> ds_joint.repeat( count <span class="op">=</span> <span class="dv">2</span> ).batch(<span class="dv">3</span>, drop_remainder <span class="op">=</span> <span class="va">True</span> )</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_rpt2 :</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>( item[<span class="dv">0</span>].numpy(),<span class="st">':'</span>, item[<span class="dv">1</span>].numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.16513085 0.9014813  0.6309742 ]
 [0.4345461  0.29193902 0.64250207]
 [0.9757855  0.43509948 0.6601019 ]] : [1 2 3]
[[0.60489583 0.6366315  0.6144488 ]
 [0.8893349  0.6277617  0.53197503]
 [0.02597821 0.44087505 0.25267076]] : [4 5 6]
[[0.8862232  0.88729346 0.78728163]
 [0.05955195 0.0710938  0.3084147 ]
 [0.25118268 0.9084705  0.47147965]] : [7 8 9]
[[0.24238515 0.63300395 0.5860311 ]
 [0.16513085 0.9014813  0.6309742 ]
 [0.4345461  0.29193902 0.64250207]] : [10  1  2]
[[0.9757855  0.43509948 0.6601019 ]
 [0.60489583 0.6366315  0.6144488 ]
 [0.8893349  0.6277617  0.53197503]] : [3 4 5]
[[0.02597821 0.44087505 0.25267076]
 [0.8862232  0.88729346 0.78728163]
 [0.05955195 0.0710938  0.3084147 ]] : [6 7 8]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:51.662741: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-68" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ppt 56번 제일 흔하게 씀</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>ds_all <span class="op">=</span> ds_joint.shuffle( <span class="bu">len</span>(X) ).batch( <span class="dv">3</span> ).repeat( <span class="dv">2</span> )</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> ds_all :</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>( item[<span class="dv">0</span>].numpy(),<span class="st">':'</span>, item[<span class="dv">1</span>].numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.8893349  0.6277617  0.53197503]
 [0.16513085 0.9014813  0.6309742 ]
 [0.25118268 0.9084705  0.47147965]] : [5 1 9]
[[0.05955195 0.0710938  0.3084147 ]
 [0.9757855  0.43509948 0.6601019 ]
 [0.8862232  0.88729346 0.78728163]] : [8 3 7]
[[0.24238515 0.63300395 0.5860311 ]
 [0.4345461  0.29193902 0.64250207]
 [0.60489583 0.6366315  0.6144488 ]] : [10  2  4]
[[0.02597821 0.44087505 0.25267076]] : [6]
[[0.16513085 0.9014813  0.6309742 ]
 [0.02597821 0.44087505 0.25267076]
 [0.4345461  0.29193902 0.64250207]] : [1 6 2]
[[0.24238515 0.63300395 0.5860311 ]
 [0.8862232  0.88729346 0.78728163]
 [0.8893349  0.6277617  0.53197503]] : [10  7  5]
[[0.9757855  0.43509948 0.6601019 ]
 [0.05955195 0.0710938  0.3084147 ]
 [0.60489583 0.6366315  0.6144488 ]] : [3 8 4]
[[0.25118268 0.9084705  0.47147965]] : [9]</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:19:52.244921: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
</section>
<section id="선형회귀분석-low-lever-ver." class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="선형회귀분석-low-lever-ver."><span class="header-section-number">2.6</span> 6. 선형회귀분석 (low-lever ver.)</h2>
<div id="cell-70" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alpha=0.8, beta=0.2, error term 일반적인 선형회귀식</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> tf.random.uniform( minval<span class="op">=</span><span class="dv">0</span>, maxval<span class="op">=</span><span class="dv">10</span>, shape<span class="op">=</span>(<span class="dv">36</span>,))</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> <span class="fl">0.2</span> <span class="op">*</span> X <span class="op">+</span> <span class="fl">0.8</span> <span class="op">+</span> tf.random.normal(mean<span class="op">=</span><span class="dv">0</span>, stddev<span class="op">=</span><span class="fl">0.15</span>, shape<span class="op">=</span>(<span class="dv">36</span>, ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-71" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>plt.plot(X, Y, <span class="st">'ro'</span>, label<span class="op">=</span><span class="st">'Original Data'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="딥러닝실습_files/figure-html/cell-66-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-72" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 훈련데이터와 평가데이터로 구분</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>trainX, testX <span class="op">=</span> tf.split( X, num_or_size_splits<span class="op">=</span> [<span class="dv">30</span>, <span class="dv">6</span>] )</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>trainY, testY <span class="op">=</span> tf.split( Y, num_or_size_splits<span class="op">=</span> [<span class="dv">30</span>, <span class="dv">6</span>] )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-73" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>ds_train <span class="op">=</span> tf.data.Dataset.from_tensor_slices( ( trainX, trainY ) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-74" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>W <span class="op">=</span> tf.Variable( np.random.randn() )</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> tf.Variable( np.random.randn() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-75" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( W.numpy(), b.numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.8828039 -0.736979</code></pre>
</div>
</div>
<div id="cell-76" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># y^=wx=b</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="co"># L = sum(y^-y)**2</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> linear_regression( x ):</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> tf.add( tf.multiply( W, x ), b )</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mean_square( ypred, y ):</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> tf.reduce_mean( tf.square( y<span class="op">-</span>ypred ) )</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>optimizer <span class="op">=</span> tf.optimizers.SGD( learning_rate<span class="op">=</span> <span class="fl">0.01</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-77" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>num_epochs <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>log_steps <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>batch_size <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>steps_per_epoch <span class="op">=</span> <span class="bu">int</span>( np.ceil( <span class="bu">len</span>(ds_train)<span class="op">/</span> batch_size ) )</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>L<span class="op">=</span>[]</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>ds_train <span class="op">=</span> ds_train.shuffle( buffer_size <span class="op">=</span> <span class="bu">len</span>( ds_train ) ).batch( batch_size ).repeat( count<span class="op">=</span>num_epochs )</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>( ds_train )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>600</code></pre>
</div>
</div>
<div id="cell-78" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># enumerate : index와 item을 동시에 반환함</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, batch <span class="kw">in</span> <span class="bu">enumerate</span>( ds_train ):</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  bX, bY <span class="op">=</span> batch</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pred, loss의 미니배치별 반복연산을 tape에 저장 (tf.GT함수)</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">with</span> tf.GradientTape() <span class="im">as</span> tape:</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> linear_regression( bX )</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> mean_square( pred, bY ) <span class="co"># 각 미치배치에 대한 MSE</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 미분값 자동 계산하여 gradient 산출 (손실함수, [변수]) &gt; output은 gredient vector 형태</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>  gradients <span class="op">=</span> tape.gradient( loss, [W, b] )</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 위 gredient를 이용해서 W, b의 값 자체를 업데이트시킴</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>  optimizer.apply_gradients( <span class="bu">zip</span>( gradients, [W, b] ) )</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> i <span class="op">%</span> log_steps <span class="op">==</span> <span class="dv">0</span> :</span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>( i, loss.numpy(), W.numpy(), b.numpy() )</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>    L.append( loss.numpy() )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 7.52958 0.5514875 -0.78580034
50 0.6072274 0.4242987 -0.52097505
100 0.618061 0.36404002 -0.29201853
150 0.15292463 0.36243728 -0.09439203
200 0.21440308 0.30857712 0.060085576
250 0.08130302 0.29104465 0.19385691
300 0.07720743 0.28864947 0.30360907
350 0.050805908 0.25714234 0.39301616
400 0.02672484 0.25849962 0.47066927
450 0.014631959 0.2344376 0.53165174
500 0.07283725 0.23046146 0.5840433
550 0.06650426 0.23649402 0.63017404</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2024-09-12 11:24:24.415082: W tensorflow/core/framework/local_rendezvous.cc:404] Local rendezvous is aborting with status: OUT_OF_RANGE: End of sequence</code></pre>
</div>
</div>
<div id="cell-79" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>plt.plot(X, Y, <span class="st">'ro'</span>, label<span class="op">=</span><span class="st">'Original Data'</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>plt.plot(X, np.array( W <span class="op">*</span> X <span class="op">+</span> b ), label<span class="op">=</span><span class="st">'Fitted Line'</span> )</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="딥러닝실습_files/figure-html/cell-74-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-80" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>plt.plot(L, <span class="st">'bo-'</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Train Loss'</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'iter'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>Text(0.5, 0, 'iter')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="딥러닝실습_files/figure-html/cell-75-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-81" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>tpred <span class="op">=</span> linear_regression( testX )</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>test_mse <span class="op">=</span> mean_square( tpred, testY )</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>test_mse.numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>0.054581102</code></pre>
</div>
</div>
</section>
<section id="선형회귀분석-tf.keras-ver." class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="선형회귀분석-tf.keras-ver."><span class="header-section-number">2.7</span> 7. 선형회귀분석 (tf.keras ver.)</h2>
<div id="cell-83" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>ds_train2 <span class="op">=</span> tf.data.Dataset.from_tensor_slices((trainX, trainY))</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>ds_train2 <span class="op">=</span> ds_train2.shuffle(<span class="dv">30</span>).batch(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-84" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> tf.keras.models.Sequential()</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>model.add( tf.keras.layers.Dense(<span class="dv">1</span>, input_dim <span class="op">=</span> <span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/Users/hwan/.pyenv/versions/3.10.14/envs/hwan/lib/python3.10/site-packages/keras/src/layers/core/dense.py:87: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential"</span>
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                    </span>┃<span style="font-weight: bold"> Output Shape           </span>┃<span style="font-weight: bold">       Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ dense (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                   │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">1</span>)              │             <span style="color: #00af00; text-decoration-color: #00af00">2</span> │
└─────────────────────────────────┴────────────────────────┴───────────────┘
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">2</span> (8.00 B)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">2</span> (8.00 B)
</pre>
</div>
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>
</div>
</div>
<div id="cell-85" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>( loss<span class="op">=</span><span class="st">'mse'</span>, optimizer <span class="op">=</span> tf.keras.optimizers.SGD( learning_rate<span class="op">=</span><span class="fl">0.01</span> ) )</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit( ds_train2, epochs<span class="op">=</span><span class="dv">100</span>, verbose<span class="op">=</span><span class="dv">1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 1ms/step - loss: 9.2056   
Epoch 2/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 754us/step - loss: 0.1788
Epoch 3/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 830us/step - loss: 0.2041
Epoch 4/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 629us/step - loss: 0.1412
Epoch 5/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 722us/step - loss: 0.1873
Epoch 6/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 712us/step - loss: 0.1623
Epoch 7/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 911us/step - loss: 0.1415
Epoch 8/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 647us/step - loss: 0.1558
Epoch 9/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 1ms/step - loss: 0.1734
Epoch 10/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 560us/step - loss: 0.1475
Epoch 11/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 613us/step - loss: 0.1752
Epoch 12/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 729us/step - loss: 0.1125
Epoch 13/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 529us/step - loss: 0.1356
Epoch 14/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 672us/step - loss: 0.1163
Epoch 15/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 645us/step - loss: 0.0936
Epoch 16/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 949us/step - loss: 0.1252
Epoch 17/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 934us/step - loss: 0.1352
Epoch 18/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 769us/step - loss: 0.0969
Epoch 19/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 883us/step - loss: 0.0930
Epoch 20/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 1ms/step - loss: 0.0873
Epoch 21/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 849us/step - loss: 0.0812
Epoch 22/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 632us/step - loss: 0.0802
Epoch 23/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 567us/step - loss: 0.0840
Epoch 24/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 650us/step - loss: 0.0755
Epoch 25/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 1ms/step - loss: 0.0970
Epoch 26/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 664us/step - loss: 0.0781
Epoch 27/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 1ms/step - loss: 0.0698
Epoch 28/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 676us/step - loss: 0.1052
Epoch 29/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 2ms/step - loss: 0.0698
Epoch 30/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 959us/step - loss: 0.0751
Epoch 31/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 620us/step - loss: 0.0814
Epoch 32/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 703us/step - loss: 0.0579
Epoch 33/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 769us/step - loss: 0.0752
Epoch 34/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 701us/step - loss: 0.0487
Epoch 35/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 574us/step - loss: 0.0602
Epoch 36/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 720us/step - loss: 0.0826
Epoch 37/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 551us/step - loss: 0.0546
Epoch 38/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 595us/step - loss: 0.0613
Epoch 39/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 712us/step - loss: 0.0552
Epoch 40/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 551us/step - loss: 0.0515
Epoch 41/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 843us/step - loss: 0.0542
Epoch 42/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 617us/step - loss: 0.0401
Epoch 43/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 978us/step - loss: 0.0669
Epoch 44/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 563us/step - loss: 0.0532
Epoch 45/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 728us/step - loss: 0.0451
Epoch 46/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 568us/step - loss: 0.0468
Epoch 47/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 767us/step - loss: 0.0416
Epoch 48/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 626us/step - loss: 0.0615
Epoch 49/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 698us/step - loss: 0.0498
Epoch 50/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 606us/step - loss: 0.0507
Epoch 51/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 823us/step - loss: 0.0406
Epoch 52/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 543us/step - loss: 0.0414
Epoch 53/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 702us/step - loss: 0.0328
Epoch 54/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 528us/step - loss: 0.0382
Epoch 55/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 867us/step - loss: 0.0480
Epoch 56/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 681us/step - loss: 0.0454
Epoch 57/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 592us/step - loss: 0.0360
Epoch 58/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 549us/step - loss: 0.0473
Epoch 59/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 846us/step - loss: 0.0390
Epoch 60/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 560us/step - loss: 0.0338
Epoch 61/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 552us/step - loss: 0.0294
Epoch 62/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 622us/step - loss: 0.0294
Epoch 63/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 756us/step - loss: 0.0449
Epoch 64/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 626us/step - loss: 0.0288
Epoch 65/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 554us/step - loss: 0.0272
Epoch 66/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 645us/step - loss: 0.0283
Epoch 67/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 11ms/step - loss: 0.0394
Epoch 68/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 3ms/step - loss: 0.0272
Epoch 69/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 651us/step - loss: 0.0258
Epoch 70/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 570us/step - loss: 0.0260
Epoch 71/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 554us/step - loss: 0.0219
Epoch 72/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 708us/step - loss: 0.0274
Epoch 73/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 563us/step - loss: 0.0280
Epoch 74/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 590us/step - loss: 0.0249
Epoch 75/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 1ms/step - loss: 0.0451
Epoch 76/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 843us/step - loss: 0.0315
Epoch 77/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 665us/step - loss: 0.0271
Epoch 78/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 604us/step - loss: 0.0217
Epoch 79/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 1ms/step - loss: 0.0219 
Epoch 80/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 601us/step - loss: 0.0285
Epoch 81/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 525us/step - loss: 0.0224
Epoch 82/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 685us/step - loss: 0.0315
Epoch 83/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 588us/step - loss: 0.0224
Epoch 84/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 860us/step - loss: 0.0208
Epoch 85/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 494us/step - loss: 0.0243
Epoch 86/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 617us/step - loss: 0.0307
Epoch 87/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 623us/step - loss: 0.0206
Epoch 88/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 668us/step - loss: 0.0332
Epoch 89/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 514us/step - loss: 0.0222
Epoch 90/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 525us/step - loss: 0.0257
Epoch 91/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 754us/step - loss: 0.0249
Epoch 92/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 746us/step - loss: 0.0270
Epoch 93/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 511us/step - loss: 0.0190
Epoch 94/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 664us/step - loss: 0.0302
Epoch 95/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 674us/step - loss: 0.0335
Epoch 96/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 649us/step - loss: 0.0241
Epoch 97/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 499us/step - loss: 0.0279
Epoch 98/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 953us/step - loss: 0.0254
Epoch 99/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 777us/step - loss: 0.0289
Epoch 100/100
6/6 ━━━━━━━━━━━━━━━━━━━━ 0s 635us/step - loss: 0.0236</code></pre>
</div>
</div>
<div id="cell-86" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>model.weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>[&lt;KerasVariable shape=(1, 1), dtype=float32, path=sequential/dense/kernel&gt;,
 &lt;KerasVariable shape=(1,), dtype=float32, path=sequential/dense/bias&gt;]</code></pre>
</div>
</div>
<div id="cell-87" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>W2 <span class="op">=</span> model.weights[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> model.weights[<span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( W2, b2 )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(0.21501322, shape=(), dtype=float32) tf.Tensor(0.7366244, shape=(), dtype=float32)</code></pre>
</div>
</div>
<div id="cell-88" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>plt.plot(X, Y, <span class="st">'ro'</span>, label<span class="op">=</span><span class="st">'Original Data'</span>)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>plt.plot(X, np.array( W2 <span class="op">*</span> X <span class="op">+</span> b2 ), label<span class="op">=</span><span class="st">'Fitted Line'</span> )</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="딥러닝실습_files/figure-html/cell-82-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-89" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>tpred2 <span class="op">=</span> model.predict( testX )</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>test_mse2 <span class="op">=</span> mean_square( tpred2, testY )</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>test_mse2.numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1/1 ━━━━━━━━━━━━━━━━━━━━ 0s 25ms/step</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>0.70796406</code></pre>
</div>
</div>
<div id="cell-90" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>plt.plot(history.history[<span class="st">'loss'</span>])</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'loss'</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Epoch'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>Text(0.5, 0, 'Epoch')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="딥러닝실습_files/figure-html/cell-84-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./딥러닝2.html" class="pagination-link" aria-label="딥러닝 Ch2">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">딥러닝 Ch2</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./시뮬레이션1.html" class="pagination-link" aria-label="시뮬레이션방법론 Ch1">
        <span class="nav-page-text">시뮬레이션방법론 Ch1</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>